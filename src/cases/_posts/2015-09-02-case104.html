---
layout:       case
global_menu:  cases
title:        "Microsoft Communicationシステム更改"
description:  "Microsoft社製のコミュニケーション機能、Exchange Server及びSharePoint Server、またコミュニケーション機能の基盤であるActive Directoryの更改の事例をご紹介いたします。"
keywords:     "システム更改,Microsoft Exchange,Microsoft SharePoint,Active Directory,リプレイス,事例"
date:         2015-09-02 09:53:00 +0900
PDF:          "case104"
categories:
 - "インフラ構築"
tags:
 - "Exchange Server"
 - "SharePoint Server"
 - "Active Direcrtory"
---

<section>
  <h1>{{ page.title }}</h1>
  <ul class="linkInPage">
    <li><a href="#toc-background">背景</a></li>
    <li><a href="#toc-overview">概要</a></li>
    <li><a href="#toc-sysCon">構成図</a></li>
    <li><a href="#toc-work">作業内容</a></li>
    <li><a href="#toc-mail">メールシステム移行の流れ</a></li>
    <li><a href="#toc-effect">作業効果</a></li>
    <li><a href="#toc-IHS-result">弊社利用による効果</a></li>
    <li><a href="#PdfDownload">PDFダウンロード</a></li>
  </ul>

  <section id="toc-background">
    <h2>背景</h2>
    <div class="smtSent">
    <p>お客様環境にて稼働しているシステムにて、保守切れに伴うシステム更改を計画されていました。<br />システムにはMicrosoft社製のコミュニケーション機能、Exchange Server及びSharePoint Server、またコミュニケーション機能の基盤であるActive Directoryの更改に対応可能な構築ベンダーを探しておりました。</p>
    </div>
  </section>

  <section id="toc-overview">
    <h2>概要</h2>
    <div class="smtSent">
      <table class="baseTb">
        <tbody>
          <tr>
          <th>目的</th>
          <td>インフラ基盤更改</td>
          </tr>
          <tr>
          <th>作業規模</th>
          <td>
            <ul class="grayDisc">
              <li>利用ユーザー数: 約1000人<br /><br />[既存サーバー環境]</li>
              <li>Active Directory　ドメインコントローラ &times; 2台</li>
              <li>Microsoft Exchange Server 2007 Mailbox Server &times; 2台</li>
              <li>Microsoft Exchange Server 2007 Client Access Server &times; 2台</li>
              <li>Microsoft Exchange Server 2007 Hub Transport Server &times; 4台</li>
              <li>Microsoft SharePoint Server 2013 &times; 1台<br /><br />[新サーバー環境]</li>
              <li>Active Directory　ドメインコントローラ &times; 2台</li>
              <li>Microsoft Exchange Server 2013 Mailbox Server &times; 2台</li>
              <li>Microsoft Exchange Server 2013 Client Access Server &times; 2台</li>
              <li>Microsoft SharePoint Server 2013 &times; 1台</li>
            </ul>
          </td>
          </tr>
          <tr>
          <th>作業ボリューム</th>
          <td>
            <ul class="grayDisc">
              <li>10人月</li>
            </ul>
          </td>
          </tr>
          <tr>
          <th>作業内容</th>
          <td>
            <ul class="grayDisc">
              <li>システム基本設計、移行設計、構築、試験</li>
            </ul>
          </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <section id="toc-sysCon">
    <h2>システム構成図</h2>
    <div class="smtSent">
    ＜システム構成図＞
    <div class="lightBox">
    <figure><img src="/image/cases/case104_01.png" alt="" /></figure>
    </div>
    </div>
  </section>

  <section id="toc-work">
    <h2>作業内容</h2>
    <div class="smtSent">
      <h3>1.調査・ヒアリング</h3>
      <ul class="bgrayDisc">
        <li>現状調査</li>
      </ul>
      <br>
      <p class="textIndent--style3">全体システムの構成を調査・ヒアリングを行う。</p>


      <h3>2.設計</h3>
      <ul class="bgrayDisc">
        <li>サーバー設計</li>
        <li>ネットワーク設計</li>
        <li>移行設計</li>
      </ul>
      <br>
        <p class="textIndent--style3">調査・ヒアリングを元に設計書を作成。</p>

      <h3>3.Active Direcrtory2012環境構築</h3>
      <ul class="bgrayDisc">
        <li>Active Directory2012構築</li>
      </ul>
      <br>
        <p class="textIndent--style3">Active Directory2012サーバーを2台構築する。</p>

      <h3>4.Active Direcrtory2008からActive Directory2012への移行</h3>
      <ul class="bgrayDisc">
        <li>ドメインコントローラ昇格</li>
        <li>FSMO移行</li>
        <li>同期確認</li>
      </ul>
      <br>
        <p class="textIndent--style3">ActiveDirectory2012サーバーにてドメインコントローラ昇格、FSMOの役割転送を行う。その後、Active Directory 2008とActive Directory 2012間でレプリケーションが行われたことを確認。Active Directory 2008及びActive Directory 2012が並行稼働した状態でActive Directory認証サービスの提供を開始する。</p>

      <h3>5. Microsoft Sharepoint2013環境構築</h3>
      <ul class="bgrayDisc">
        <li>Microsoft SQL Server 2012 SP1インストール</li>
        <li>Microsoft SharePoint Server 2013 インストール</li>
        <li>Microsoft SharePoint Server 2013  SP1適用</li>
        <li>Webアプリケーションの作成</li>
        <li>代替アクセス環境構成</li>
      </ul>
      <br>
        <p class="textIndent--style3">
        SharePoint Serverは諸設定まで弊社にて実施し、データ移行はお客様にて実施して頂きました。</p>

      <h3>6. Microsoft Exchange2013環境構築</h3>
        <ul class="bgrayDisc">
          <li> Microsoft Exchange2013構築(メールボックスサーバー及びクライアントアクセスサーバー)</li>
        </ul>
        <br>
        <p class="textIndent--style3">メールボックスサーバーの役割を持たせたMicrosoft Exchange2012サーバーを2台。クライアントアクセスサーバーの役割を持たせたMicrosoft Exchange2012サーバーを2台。計4台のMicrosoft Exchange2012サーバーを構築し、設定を行う。</p>

      <h3>7. Microsoft Exchange2007からMicrosoft Exchange2013への移行</h3>
        <ul class="bgrayDisc">
          <li>ユーザーメールボックス移行処理実行(フルコピー)</li>
        </ul>
        <br>
        <p class="textIndent--style3">MicrosoftExchange2007サーバーの保持するユーザーメールボックスをMicrosoft Exchange2013サーバーへフルコピーする。この時点において、ユーザーはMicrosoft Exchange2007サーバーに存在する自身のユーザーメールボックスを依然使用。</p>
        <br>

        <ul class="bgrayDisc">
          <li>ユーザーのメールシステム使用を停止</li>
          <li>ユーザーメールボックス移行処理再実行(差分コピー)</li>
        </ul>
        <br>
        <p class="textIndent--style3">ユーザーメールボックス移行(フルコピー)が行われている間にユーザーがメールシステムを利用することにより、Microsoft Exchange2007サーバーに存在するユーザーメールボックスデータとMicrosoft Exchange2013サーバーに存在するユーザーメールボックスデータの間に差分が発生。<br>
        差分データをコピーすることで、Microsoft Exchange2007サーバーに存在するユーザーメールボックスデータとMicrosoft Exchange2013サーバーに存在するユーザーメールボックスデータを完全に同一のものとする。</p>
        <br>

        <ul class="bgrayDisc">
          <li>ユーザーメールボックス移行完了処理実行</li>
          <li>ネットワーク設定変更</li>
        </ul>
        <br>
        <p class="textIndent--style3">ユーザーメールボックス移行の完了処理を実行し、移行作業終了。その後、Microsoft Exchange2013サーバーの保持するユーザーメールボックスデータを使用してメールシステムをユーザーが使用するよう、ネットワーク設定を変更する。Active Directory認証サービスについても同様にActive Directory2012サーバーのみにより提供されるようになる。</p>
        <br>

        <ul class="bgrayDisc">
          <li>移行後の動作確認</li>
        </ul>

      <h3>8.旧サーバー環境全台削除</h3>
        <ul class="bgrayDisc">
          <li>Active Directory2008削除</li>
          <li>Microsoft Exchange 2007 Client Access Server削除</li>
          <li>Microsoft Exchange 2007 Mailbox Server削除</li>
          <li>Microsoft Exchange 2007 Hub Transport Server削除</li>
          <li>旧環境後の動作確認</li>
        </ul>
    </div>
  </section>
   
  <section id="toc-mail">
    <h2>メールシステム移行の流れ</h2>
    <div class="smtSent">
      <h3>1. Microsoft Exchange2013環境構築</h3>
      <p>Microsoft Exchange2013環境を新規に構築します。<br>
      クライアントアクセスサーバー、メールボックスサーバーをそれぞれ冗長構成となるように2台ずつ構築。各種設定も行った上でMicrosoft Exchange2007環境に追加します。<br>
      この段階においてエンドユーザー様は依然、Microsoft Exchange2007環境に存在する自身のメールボックスデータを使用しています。</p>
      <br>
      <div class="lightBox">
      <figure><img src="/image/cases/case104_02.png" alt="図2" /></figure>
      <p>拡大する</p>
      </div>

      <h3>2.メールボックスフルコピー</h3>
      <p>事前にMicrosoftExchange2007環境に存在しているユーザーメールボックスデータを新規に構築したMicrosoft Exchange2013環境にフルコピーします。<br>
      フルコピー時に大量のI/Oが発生することが見込まれますが、メールシステムを停止する必要はありません。この間もエンドユーザー様にはMicrosoft Exchange2007環境を使用してメールシステムをご利用いただくことが可能です。</p>
      <div class="lightBox">
      <figure><img src="/image/cases/case104_03.png" alt="図3" /></figure>
      <p>拡大する</p>
      </div>

      <h3>3.メールボックス差分コピー</h3>
      <p>まずメールシステムの使用を停止します。これはメールの滞留処理を事前に行った上で行われます。<br>
      そしてフルコピー時より現段階までにユーザーメールボックスデータに加わった差分データをMicrosoft Exchange2013環境へコピーします。<br>
      これによりMicrosoft Exchange2013への移行準備が整います。</p>
      <div class="lightBox">
      <figure><img src="/image/cases/case104_04.png" alt="図4" /></figure>
      <p>拡大する</p>
      </div>

      <h3>4.メールシステム切り替え</h3>
      <p>Microsoft Exchange2007環境への通信を切断し、MicrosoftExchange2013環境を使用するよう、ネットワーク設定を変更します。</p>
      <div class="lightBox">
      <figure><img src="/image/cases/case104_05.png" alt="図5" /></figure>
      <p>拡大する</p>
      </div>

      <h3>5. Microsoft Exchange2007環境削除</h3>
      <p>Microsoft Exchange2013環境を使用したメールシステムの利用が確認でき次第、Microsoft Exchange2007環境の削除を行います。</p>
      <div class="lightBox">
      <figure><img src="/image/cases/case104_06.png" alt="図6" /></figure>
      <p>拡大する</p>
      </div>
      </div>
  </section>

  <section id="toc-effect">
    <h2>作業効果</h2>
    <div class="smtSent">
      <h3>1.システムの安全な移行</h3>
      <p>Active Directory及びMicrosoft Exchange2007からMicrosoft Exchange2013への移行に際しユーザー影響を最小限にとどめる必要があった為、回避すべき事象や、MicrosoftExchangeのバグ等に対して入念な事前検証作業を行うことで対応。</p>

      <h3>2.システムの完全な移行</h3>
      <p>システムの移行時に最も危惧されたのが、移行後のデータの完全性でありました。しかし最終的に日々変化するユーザーのデータを欠損なく移行。</p>

      <h3>3.ベンダーサポートの延命</h3>
      <p>Active Directory、Microsoft Exchange、Microsoft SharePoint Serverリプレイスによりベンダーからのサポートを延命。</p>
  </section>

  <section id="toc-IHS-result">
    <h2>弊社利用による効果</h2>
    <div class="smtSent">
      <h3>1.高品質なメールシステム移行</h3>
        <ul class="bgrayDisc">
          <li>メールシステム移行は非常に複雑</li>
        </ul>
        <p class="textIndent--style3">メールシステムの移行の難しさには様々な要因がございます。<br>
        まずエンドユーザーのメールの使用方法や状況により作業が複雑化するという点です。<br>
        メーラーの種類、対象ユーザーの数、ユーザーメールデータのサイズなど、これらが多ければ多いほど移行作業は膨大になります。<br>
        今回の事例ではユーザー数も多く、さらにMicrosoft Outlook、Windows Live Mail、Outlook Web Access、といった複数のメーラーが使用されていたため、移行作業は困難を極めました。</p>
        <br>
        <ul class="bgrayDisc">
          <li>ベンダーからの情報公開の限界</li>
        </ul>
        <p class="textIndent--style3">複雑な移行環境に反して、ベンダーから公開される情報に限界があるという点。ベンダーは基本的に複数の製品機能の同時移行を想定しておらず、1つの機能のみの移行を想定した情報公開を行っております。
        また、Microsoft公式技術サイトTechnet上の情報も誤差がいくつかありました。</p>
        <br>
        <ul class="bgrayDisc">
          <li>事前の検証が非常に重要</li>
        </ul>
        <p class="textIndent--style3">今回の事例では以上の理由から必然的に弊社社内での入念な検証作業が必要となりました。検証すべき項目は相当数になりましたが、その1つ1つを確実につぶしていく必要があります。<br>
        これに対し、弊社では検証すべき事象ごとに必要であれば複数の検証環境を作成することで効率的に検証作業を実施。<br>
        条件毎に1つ1つ検証を切り分け、最終的に最も安全かつ完全にメールシステムを移行する手順を準備した上で、本番環境の移行を実現することができました。

      <h3>2.利用ユーザーへの影響最小化</h3>
        今回は移行要件にダウンタイムの最小化及び移行によるエンドユーザーの端末への影響最小化という課題がありました。想定される移行時間を事前に算出、ユーザー様環境の理解、ソフトウェアの深い知識、IHS過去ナレッジを駆使し、ご期待に添えた移行を行う事が出来ました。</p>

      <h3>3.製品バグに対する柔軟な対応</h3>
        今回はMicrosoft Exchange 2013への移行でMicrosoft社も認識していなかった未知のバグが発見され、移行が困難な状況になりました。<br>
        本件ではお客様と協力し、Microsoft社よりバグフィックス用の専用コマンドの提供及び弊社にてコマンドの自動化をさせて頂き、スムーズな移行を提供する事が出来ました。<br>
        IHSではバグについても可能な限り対応させて頂いております。
    </div>
  </section>
</section>
