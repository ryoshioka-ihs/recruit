---
layout:       case
global_menu:  cases
title:        "約200台のサーバー統合・仮想化事例"
description:  "200台（ラック20本）の物理サーバーを仮想環境へ構築することにより90台(ラック5本)へ集約することに成功した事例をご紹介いたします。"
keywords:     "サーバー統合,仮想化,VMware,ランニングコスト低減,サイジング,可用性,事例"
date:         2011-09-06 13:29:00 +0900
PDF:          "case072"
categories: 
 - "インフラ構築"
tags:
 - "VMware vSphere"
 - "仮想化基盤"
---

<section>
  <h1>{{ page.title }}</h1>
  <ul class="linkInPage">
    <li><a href="#toc-background">背景</a></li>
    <li><a href="#toc-work">作業内容</a></li>
    <li><a href="#toc-effect">作業効果</a></li>
    <li><a href="#toc-IHS-result">弊社利用による効果</a></li>
    <li><a href="#PdfDownload">PDFダウンロード</a></li>
  </ul>

  <section id="toc-background">
    <h2>背景</h2>
    <div class="smtSent">
    <p>お客様のシステムは10年程前に構築されたもので、約200台のサーバーはハードウェア・ソフトウェア共に刷新が必要とされておりました。システムの刷新に際し、消費電力などのランニングコストを抑えるため、お客様は仮想環境上に新環境の構築を計画。弊社にて、仮想環境の設計、構築、移行を担当させて頂きました。</p>
    <br>
      <table class="baseTb">
        <tbody>
        <tr>
        <th>作業規模</th>
        <td>
          <ul class="grayDisc">
          <li>サーバ：約200台</li>
          <li>N/W機器：約50台</li>
          <li>ストレージ：5台</li>
          </ul>
        </td>
        </tr>
        <tr>
        <th>作業期間</th>
        <td>
          <ul class="grayDisc">
          <li>現状調査：2ヶ月</li>
          <li>設計：2週間</li>
          <li>構築：1週間</li>
          <li>移行：3週間</li>
          <li>動作確認：2週間</li>
        </ul>
        </td>
        </tr>
        <tr>
        <th>作業人数</th>
        <td>5人</td>
        </tr>
        </tbody>
      </table>
    </div>
  </section>

  <section id="toc-work">
    <h2>作業内容</h2>
    <div class="smtSent">
      <h3>現状調査</h3>
        <ul class="numList">
          <li>
          <p>ヒアリング</p>
          <p>稼動中のシステムについて、サーバーの台数、構成、用途、月末に負荷が高くなるなどの負荷傾向や、それぞれのサーバーの重要度（可用性要件）のヒアリングを実施。また、各サーバーのインベントリ情報（CPUのタイプやコア数、クロック、メモリサイズ、ディスク情報、NICタイプ、NIC転送速度等）を確認。</p>
          </li>
          <li>
          <p>パフォーマンスデータの取得</p>
          <p>株式会社アイ・アイ・エムのパフォーマンス管理ツール「ES/1」を使用し、2ヵ月間のパフォーマンスデータを取得。複数のプラットフォームのパフォーマンスデータを集約し、現状のパフォーマンスの傾向を分析。</p>
          </li>
        </ul>
      
      <h3>設計</h3>
        <ul class="numList">
          <li>
          <p>サイジング</p>
          <p>FAXやプリンタなどの仮想化に対応していないデバイスが接続されているサーバーや、VMwareに対応していないOSが稼動するサーバーなど、仮想化の対象外となるサーバーを除外。また、システムの機能統合や削除によって不要になったサーバーを除き、最終的に仮想化対象サーバーを約150台に決定。</p>
          <br>
          <p>事前調査の結果を受け、各仮想化対象サーバーの処理能力と実際のパフォーマンスから、仮想環境全体が必要とするCPU、メモリ、ストレージ、ネットワークの必要処理能力を算出。さらに、仮想化によるオーバーヘッドや、各サーバーの用途や重要度に応じた余剰を追加し、最終的な必要処理能力を確定。各サーバーの負荷傾向やハードウェアの処理能力から、ハードウェアに対する仮想マシンの組み合わせを決定。</p>
          </li>
          <li>
          <p>機器選定</p>
          <p>算出した最終的な必要処理能力を基に、サーバー、ネットワーク機器、ストレージ機器を選定。今回はデータセンターでの占有面積（ラック数）削減のため、ブレードサーバーを採用。</p>
          </li>
          <li>
          <p>可用性</p>
         <p>サーバー統合を行った場合、1つの仮想ホスト上で複数の仮想ゲストが稼働するため、仮想ゲストの障害によるサービス停止リスクは非仮想環境より大きくなります。そのため、VMwareの高可用性機能であるVMware HA, DRS, FTの導入を実施。</p>
          <br>
          <p>VMware HAは仮想ホストの障害時に仮想マシンを他の仮想ホスト上で再起動する機能、VMware DRSはリソース不足時に余裕のある他の仮想ホスト上に仮想ゲストを自動的に移動する機能、VMware FTは仮想ホストの障害時に仮想ゲストを他の仮想ホストに無停止で移動する機能です。VMware FTは仮想ゲストを無停止で正常に稼働する仮想ホストに移動できるため、可用性を大幅に向上することができる反面、仮想CPUの割り当てが1つのみ、DRSの併用不可などの制限があります。</p>
          <br>
          <p>そこで、サービス停止が許されない仮想ゲストが稼働する仮想ホストについては、グルーピングを行い、VMware FTを設定。その他の仮想ホストグループにはVMware HA, DRSの設定を実施。その結果、サービス停止が許されない仮想ゲストに対しては、リソース効率よりもサービス停止リスクの最小化を優先した環境を構築。その他の仮想ゲストには耐障害性とリソース効率を両立した環境を実現しました。</p>
          </li>
        </ul>
      
      <h3>構築・移行</h3>
        <ul class="numList">
          <li>
          <p>物理サーバ－</p>
          <p>仮想基盤、ネットワーク、ストレージの設定、接続を行い、疎通を確認。</p>
          </li>
          <li>
          <p>仮想ゲスト</p>
          <p>既存環境からP2V移行を実施。VMware vSphere未対応の古いLinux OSに関しては、仮想環境上に最新のOSで再構築。</p>
          </li>
        </ul>
        <div class="lightBox">
        <figure><img src="/image/cases/case072_01.png" alt="図1" /></figure>
        </div>
    </div>
  </section>

  <section id="toc-effect">
    <h2>作業効果</h2>
    <div class="smtSent">
    <p>作業の結果、200台（ラック20本）の物理サーバーを90台(ラック5本)へ集約することに成功。物理サーバ－を半数以下に、使用ラック数を1/4に削減することで、ランニングコストを大幅に抑えることができました。</p>
    </div>
  </section>

  <section id="toc-IHS-result">
    <h2>弊社利用による効果</h2>
    <div class="smtSent">
      <h3>1.パフォーマンスデータに基づくサーバー統合計画</h3>
      <p>大規模な仮想化移行には、サーバーのサイジングが非常に重要です。今回のケースでは、パフォーマンス管理ツールES/1で得られたパフォーマンスデータとハードウェアのベンチマークデータを基にサーバーのサイジングを実施。パフォーマンスデータはパフォーマンス分析専門の技術者が分析を担当し、既存環境のボトルネック解消を含めたサイジングを行いました。その結果、サーバー統合によるパフォーマンスの悪化を招くことなく、提供サービスのレスポンスを向上することができました。</p>

      <h3>2.仮想環境の運用をトータルサポート</h3>
      <p>仮想化移行後もES/1を使用し、月次のパフォーマンスレポートを作成。状況に応じたリソース割当量の調整や仮想マシンの設定変更など、仮想化後の運用もワンストップで対応しております。</p>
      <p>IHSでは、VMware製品・Microsoft製品(Hyper-V)を使用したサーバー統合、運用を行っております。仮想化の設計、構築、運用でお困りのことがございましたら、お気軽にお問い合わせください。</p>
    </div>
  </section>
</section>

