---
layout:       case
global_menu:  cases
title:        "PowerShell を用いた運用の自動化"
description:  "IIMヒューマンソリューションの担当者により、これまで手動で運用していたActive Directoryの運用作業をPowerShellを用い、自動化するご支援をさせていただいた事例をご紹介しています。
限られた時間の中で件数の多い登録作業をスクリプトで一括処理することにより、ミスなく、かつ時間内に対応を完了させることができました。
"
keywords:     "Active Directory,PowerShell,自動化"
date:         	2019-06-10 00:00:00 +0900
PDF:          "case166"
categories:
 - "インフラ運用"

tags:
 - "Active Directory"
 - "PowerShell"
 - "自動化"
---

<section>
  <h1>{{ page.title }}</h1>
  <ul class="linkInPage">
    <li><a href="#toc-1">背景</a></li>
    <li><a href="#toc-2">概要</a></li>
    <li><a href="#toc-3">作業効果</a></li>
    <li><a href="#toc-4">弊社利用による効果</a></li>
    <li><a href="#toc-5">作業内容の詳細</a></li>
    <li><a href="#PdfDownload">PDFダウンロード</a></li>
  </ul>

  <section id="toc-1">
    <h2>背景</h2>
    <div class="smtSent">
      <p>今回のお客様は、国内大手輸送会社です。社内では Active Directory  が広範囲の IT システムで使用されており、長い期間にわたりオブジェクトの登録やその他の付随する情報全てを手動で運用しておりました。しかしながら、 Active Directory の活用範囲がさらに広がっていることもあり、手動では少人数による効率的な運用が難しい状況になってくると判断したため、Active Directory の管理作業を OS に標準で搭載されており、導入までのハードルが比較的低い PowerShell を用い、自動化する運用を提案させていただきました。</p>
      <p>同時期にお客様の社内では自動化の関心が高まりつつあったことから、本件のご提案を受け入れてくださり、自動化の対応を実施することができました。</p>
    </div>
  </section>

  <section id="toc-2">
    <h2>概要</h2>
    <div class="smtSent">
      <table class="baseTb">
        <tbody>
          <tr>
            <th>業種</th>
            <td>輸送業</td>
          </tr>
          <tr>
            <th>目的</th>
            <td>作業工数の削減、作業品質の担保</td>
          </tr>
          <tr>
            <th>作業規模</th>
            <td>
            	<ul class="grayDisc">
            		<li>利用ユーザー数： 約 20,000 名</li>
            		<li>総サーバー台数： 9 台</li>
            	</ul>
            </td>
          </tr>
          <tr>
            <th>作業ボリューム</th>
            <td>約 2.5 人月</td>
          </tr>
          <tr>
            <th>作業内容</th>
            <td>
            	<ul class="grayDisc">
            		<li>自動化計画の検討</li>
            		<li>スクリプト作成と検証</li>
            		<li>実装と効果測定</li>
            	</ul>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <section id="toc-3">
    <h2>作業効果</h2>
    <div class="smtSent">

    	<h3>作業工数を削減</h3>
    	<p><b>＜課題の詳細＞</b></p>
    	<p>Active Directory へのオブジェクト登録作業は月 2 回の定期作業で実施しておりましたが、月に 100 件を超える依頼が入ることもあります。その登録作業を 1 件ずつ手動で実施しており、依頼数が増加するに従って作業時間が増大していました。</p>
    	<br>
    	<p><b>＜どのように改善したか＞</b><br>
    	<p>スクリプトで一括処理することで依頼数が増加しても作業時間への影響が出ないようにしました。</p>
    	<br>
    	<p><b>＜どんな効果があったか＞</b></p>
    	<p>依頼数が 100 件を超えていてもこれまでと同じ作業時間内に作業が完了することが出来ています。</p>

    	<h3>作業品質の担保</h3>
    	<p><b>＜課題の詳細＞</b><br>
    	限られた時間内で登録作業を完了させなければならず、急ぎで対応することが続き作業ミスの発生率が高い状態となっていました。</p>
    	<br>
    	<p><b>＜どのように改善したか＞</b><br>
    	スクリプトを関係者全員が確認する手順を加え、確認したスクリプトを利用し、一括処理することで人為的な作業ミスが発生しないようにしました。</p>
    	<br>
    	<p><b>＜どんな効果があったか＞</b><br>
    	これまでは作業実施者のみがパラメーターを手順書に記載していたので、作業実施者の思い込み等によりミスに気づかず作業を実施してしまうこともありましたが、スクリプトに読み込ませるためのCSV データーを作業関係者全員が目視で確認する手順を踏むことにより、ミスの有無を確認し、結果的にミスを減らすことができました。</p>

    </div>
  </section>

  <section id="toc-4">
    <h2>弊社利用による効果</h2>
    <div class="smtSent">

    	<h3>運用に深く関わっているからこその付加価値</h3>
    	<p>弊社要員はお客様の環境において Active Directory の運用に深く関わっております。その環境の知識を活かし、単純に Active Directory のオブジェクトを作成するだけでなく当該お客様の環境に必要な追加設定（例えば、お客様特有のネーミングルールに依存した設定等）も併せて実行されるようスクリプトを構成することができました。</p>
    	<p>既製のパッケージ製品等を購入するよりも、お客様の環境での運用を熟知した弊社の担当者がスクリプトを記述することにより、コストを抑え、かつ高い効果を発揮することに成功しました。</p>
    </div>
  </section>


  <section id="toc-5">
    <h2>作業内容の詳細</h2>
    <div class="smtSent">
      <h3>自動化計画の検討</h3>
      <ul class="grayDisc">
      	<li>既存作業内容の可視化（作業発生頻度と作業件数の集計や作業時間の計測）</li>
      	<li>スクリプトで作業を自動化した場合の工数削減目標設定</li>
      </ul>

      <h3>スクリプト作成と検証</h3>
      <ul class="grayDisc">
      	<li>スクリプト設計書の作成</li>
      	<li>開発用の環境における動作検証</li>
      </ul>

      <h3>実装と効果測定</h3>
      <ul class="grayDisc">
      	<li>本番用の環境における実装</li>
      	<li>工数削減効果の測定<br>
      		<div style="margin-left: 20px;">
      			実装前：月間で約 4 時間～ 6 時間の作業時間<br>
      			実装後：月間で約 30 分の作業時間<br>
      			⇒月間で 3 時間 30 分～ 5 時間 30 分の工数削減に成功
      		</div>
      	</li>
      	<li>作業ミス発生件数の測定<br>
      		<div style="margin-left: 20px;">
      			実装前：発生件数 0 件<br>
      			実装後：発生件数 0 件<br>
      			⇒元々数か月以上ミスは発生していなかったため明確には実感しづらいものの品質の低下は起きていない
      		</div>
      	</li>
      </ul>
  	</div>
  </section>



</section>

