---
title:         "Windows 7移行の注意点"
description:   ""
keywords:      ""
date:          2011-02-17 00:00:00 +0900
link:		   ""
categories:
- "技術レポート"
tags:
---

<p>世の中にWindows 7が登場してある程度落ち着いてきました。各企業様も従来の環境を移行することを検討される時期ではないでしょうか？今回の記事では、Windows 7へ移行するにあたり、Windows 7への移行注意点をご紹介致します。</p>
<h3>Windows クライアントの背景</h3>
<p>Windows XPを使用してきたユーザのハードウェア環境は、陳腐化・老朽化が進んでいます。例えば、現在運用中のPCが破損・故障し、新しいPCを調達したいと考えた時に、Windows XP環境は終息されているため、従来の運用を行う事が困難となります。そこで、既存のアプリケーションに関してはWindows7に移行することを検討しなければなりません。</p>
<h3>Windows 7への移行注意点</h3>
<p>では、実際にWindows 7へ移行するために、どんな点に気を付けなければならないのか考えていきましょう。</p>
<br>
<p>OS移行の問題として、互換性が挙げられます。特に、Windows XP からの移行では多くの機能が追加・変更された上、セキュリティが大幅に強化されているため、脆弱なアプリケーションでは互換性問題や、それ以外にも注意すべき点が多々あります。</p>

<h2>互換性の問題</h2>
<p>Windows7環境上で正常に動作しない場合の対処方法を以下に記載します。</p>
<h3>アプリケーションのアップデート</h3>
<p>Windows7環境上で使用するアプリケーションを、Windows7対応版にアップデートすることで、そのアプリケーションが正しく実行できるようにします。</p>
<small class="notes">※ソフトウェア・ベンダーへサポート等の確認をしておく必要があります。</small>
<h3>互換フィックス (Compatibility Fixes)</h3>
<p>OSのバージョンチェックを行っているアプリケーションの場合、以前の OS のバージョン番号を返すことで、そのアプリケーションが正しく実行できるようにします。設定には、以下の互換モードを使用します。</p>
<h3>互換モード (Compatibility Modes)</h3>
<p>互換フィックスを組み合わせて一括設定することで、特定の実行環境を再現するモードです。例えば、セキュリティ制限に触れてアプリケーションが動作しない場合などに、旧バージョンのセキュリティ・レベルを再現することで問題を解決できる場合があります。</p>
<div class="lightBox">
	<figure>
		<img src="/image/reports/techRep016_01.jpg" alt="Setup.exeのプロパティ">
	</figure>
</div>

<h2>その他の問題</h2>
<p>互換性の問題の他に、移行に際して注意しなければならないことを、以下に記載していきます。</p>
<h3>UAC（User Account Control）機能の強化</h3>
<p>Windows 7 では、Windows XPと比べて管理者ユーザの扱いに大きな違いがあります。Windows XPであれば、「管理者」に分類されるユーザ・アカウントでログオンすると、常に管理者の権限を維持した状態になりますが、Windows 7では「管理者」に分類されるユーザ・アカウントでログオンしても、強制的に制限付きユーザ（標準ユーザ）と同じ権限しか持ちません。そのため、管理者権限が必要なアプリケーションは正常に動作しない場合があります。</p>
<br>
<h4>解決策</h4>
<p>この場合は、下図のオプションを有効にすることで、常に Administrators 権限で実行することができます。</p>
<div class="lightBox">
	<figure>
		<img src="/image/reports/techRep016_02.jpg" alt="Microsoft Office Excel 2007のプロパティ">
	</figure>
</div>

<h3>プロファイル・フォルダ構成の変更</h3>
<p>Windows7では、Windows XPからプロファイル・フォルダ構成が変更されています。そのため、アプリケーション・ソフトウェア等でプロファイル・フォルダのパスを固定で指定している場合不具合を起こす可能性があります。アプリケーションによっては、内部のパスを指定している箇所を修正することで対応可能な場合もあります。</p>
<br>
<p>フォルダ構成の違いについては下表を参照してください（抜粋）</p>
<table class="baseTb rangeTb">
	<thead>
		<tr>
			<th width="189">&nbsp;</th> <th width="180">
			<p align="center">Windows XP</p>
		</th> <th width="165">
		<p align="center">Windows Vista／7</p>
	</th>
</tr>
</thead>
<tbody>
	<tr>
		<th width="189" valign="top">
			<p>ユーザプロファイル・フォルダ</p>
		</th>
		<td width="180" valign="top">
			<p>Documents and Settings</p>
		</td>
		<td width="165" valign="top">
			<p>Users</p>
		</td>
	</tr>
	<tr>
		<th width="189" valign="top">
			<p>ユーザ毎のアプリケーション・データフォルダ</p>
		</th>
		<td width="180" valign="top">
			<p>{UserName}\Application   Data\{UserName}\Local Settings\Application Data</p>
		</td>
		<td width="165" valign="top">
			<p>AppData\Roaming<br /> AppData\Local</p>
		</td>
	</tr>
	<tr>
		<th width="189" valign="top">
			<p>All Usersのプロファイル・フォルダ</p>
		</th>
		<td width="180" valign="top">
			<p>All Users</p>
		</td>
		<td width="165" valign="top">
			<p>Public</p>
		</td>
	</tr>
	<tr>
		<th width="189" valign="top">
			<p>All Users プロファイルのアプリケーション・データフォルダ</p>
		</th>
		<td width="180" valign="top">
			<p>All Users\Application Data</p>
		</td>
		<td width="165" valign="top">
			<p>ProgramData</p>
		</td>
	</tr>
	<tr>
		<th width="189" valign="top">
			<p>デスクトップ</p>
		</th>
		<td width="180" valign="top">
			<p>%UserProfile%\デスクトップ</p>
		</td>
		<td width="165" valign="top">
			<p>%UserProfile%\Desktop</p>
		</td>
	</tr>
</tbody>
</table>

<h3>Internet Explorer８ の機能強化</h3>
<p>Windows7にはInternet Explorer８が標準搭載されています。IE ８の保護モードにより、既存アプリケーションでは、以下のような問題が発生することがあります。</p>
<ul class="grayDisc">
	<li>アドオンなどで上位権限のリソースにアクセスできない</li>
	<li>アドオンなど、IE にロードされたモジュールの設定情報を、IE 以外のプロセスと共有できない</li>
</ul>
<br>
<p>例えば、帳票の出力を行うWebシステムなど、IEのアドオン機能（ActiveX）を使用するシステムで不具合が発生する場合があります。</p>
<br>
<h4>解決策</h4>
<p>この問題は、「管理者として実行」（UAC（User Account Control）機能の強化参照）、またはIE ８の保護モードを無効にすることで解消される場合があります。</p>

<h3>その他</h3>
<p>ユーザデータの移行については、マイクロソフトから以下のツールが提供されています。</p>
<br>
<ul class="grayDisc">
	<li>Windows転送ツール<br>
	旧環境のOS上のファイル、写真、音楽、電子メール、設定内容などをコピーできます。データの転送には、転送ツール ケーブル、リムーバブル メディア、またはネットワーク接続を使用できます。</li>
	<li>User State Migration Tool 4.0<br>
	ユーザ アカウント、オペレーティング システム、およびアプリケーション設定を安全に移行することができます。</li>
</ul>

<h2>データ移行ツール</h2>
<p>前述の通り、Windows7では、ユーザープロファイルの構造が変更されているため、XP環境で使用していたユーザープロファイルを単純にコピーすると、データや設定が失われる等、大きな問題が生じる可能性があります。</p>
<br>
<p>Microsoftでは、設定情報の円滑な移行のために以下のツールが提供されています。</p>
<h3>Windows転送ツール</h3>
	<p>旧環境のOS上のファイル、写真、音楽、電子メール、設定内容などをコピーすることが可能で、個人用データや設定のセットアップ作業が格段に容易になります。<br />
	データの転送には、転送ツールケーブル、リムーバブルメディア、外付けドライブ、またはネットワーク接続を使用できます。</p>
<div class="heed" style="margin-top: 1em;">
	<section>
		<h2>Windows転送ツールの注意点</h2>
			<p>辞書データ等の隠し属性ファイルは、表示されていない場合、転送されません。</p>
	</section>
</div>

<h3>ユーザー状態移行ツールキット (USMT: User State Migration Tool 4.0)</h3>
<p>Windows転送ツールの機能を拡張したスクリプト可能なコマンドラインツールで、大規模な複数ユーザーの移行を行うことができます。<br />
移行するユーザーアカウント、ファイル、および設定と、これらの移行方法を正確に制御することにより、実際の状況に応じて移行を構成できます。</p>
<div class="heed" style="margin-top: 1em;">
	<section>
		<h2>USMTの注意点</h2>
		<p>USMTは大規模な自動展開を実行する管理者を対象としており、エンドユーザーによる操作が必要な移行やコンピューターごとのカスタマイズが必要な移行には推奨されていません。<br />
		また、USMTを使用するには管理者資格情報を持つアカウントから実行する必要があります。管理者モードで実行しない場合、一部のデータが移行されません。</p>
	</section>
</div>
<br>
<p>上記内容に関して、ご不明な点またはご質問などがございましたら、お気軽にお問い合わせ下さい。また、Windows7移行・展開に関しましてご興味がございましたら、 IIMヒューマン・ソリューション営業担当までお問い合わせ下さい。</p>