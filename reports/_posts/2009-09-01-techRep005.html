---
title:         "仮想化環境における構築・運用のポイント 第5回"
description:   "サーバの仮想化は、昨今のIT業界において注目されているテーマの1つです。当社ではVMware Infrastructure導入作業、運用手順書作成などの実績から、仮想化環境構築のノウハウをご紹介します。"
keywords:      "仮想化,VMware,vShere,vCenter,ESXi"
date:          2009-09-17 00:00:00 +0900
link:		   ""
categories:
- "技術レポート"
tags:
---
<div class="msgWrap">
	<p>これまでは、仮想化のメリットとして取り上げられることが多い、下記3項目についてご紹介してきました。</p>
	<ul class="grayDisc">
		<li>物理サーバの配置</li>
		<li>ハードウェア保守切れおよび陳腐化への対応</li>
		<li>本番・保守・開発・テスト・リハーサル環境の効率化</li>
	</ul>
	<br>
	<p>そこで今回は、仮想化検討の際に最も心配となることの1つである、パフォーマンスの問題について考えてみたいと思います。</p>
</div>

<h2>サーバ個々のパフォーマンスチューニング</h2>
<div class="msgWrap">
	<p>お客様に仮想化のご提案をする場合、必ずと言っていいほどパフォーマンスに関する質問をお受けします。確かに、現状では、物理サーバに直接OSを導入する場合とまったく同じパフォーマンスを仮想化環境で得られるとは明言できません。しかしながら、ハードウェア性能の向上や仮想化技術の進歩によって、この差は日々縮まりつつあります。</p>
	<p>ご参考までに、2009年現在IBMより提供されている最新のサーバのスペックは、次の通りです。</p>
	<ul class="grayDisc">
		<li>CPU ：2.93GHz Quad-Core ×2個</li>
		<li>Memory ：128GB</li>
		<li>HDD ：3.6TB</li>
	</ul>
	<br>
	<p>上記は全て最大スペックでの話ですが、1つのOSに対してこのスペックの最大処理性能を要求するシステムは、まだ少数ではないでしょうか。</p>
	<h3>パフォーマンス低下の要因</h3>
	<p>仮想化環境においてパフォーマンス低下の要因となる項目は、大きく分けて次の2つです。</p>
	<ul class="grayDisc">
		<li>物理サーバとOSの間に仮想化層を挟むことによるオーバーヘッド</li>
		<li>1台の物理サーバで複数のOSが動作することによる負荷の増大</li>
	</ul>
	<br>
	<p>これらは、仮想化製品の性能にも依存しますが、下記を実施することで改善できる部分もあります。以下では、パフォーマンス面から見た導入時のポイントをご紹介していきます。</p>
</div>

<h2>付属のツールをインストールする</h2>
<div class="msgWrap">
	<p>VM製品におけるVMware Tools<small class="notes">（※1）</small>のように、仮想化製品に付属のツールが提供されている場合は、それらを適切にインストールすることで、パフォーマンスを向上させることができます。特に、仮想OSの画面が重く操作性が悪いなどという問題は、このようなツールを導入することで解消されるケースがほとんどです。</p>
	<p class="textIndent--style1"><small class="notes">（※1）VMware Tools：ゲスト OS の中にインストールされる、VMwareのパフォーマンスを向上させる一揃いのアドオンユーティリティ。</small></p>
</div>

<h2>相乗りサーバ同士のピーク時間帯をずらす</h2>
<div class="msgWrap">
	<p>サーバサイジングは、ピーク時間帯の使用状況をもとにして行われます。しかしどんなサーバでも、常時ピークの状態にあるわけではありません。業務システムなら営業時間中、バックアップやバッチシステムならば夜間が使用のピークで、それ以外の時間帯は、ほとんど負荷がかかっていません。</p>
	<p>よって、ピーク時間帯が異なるサーバを選んで相乗りさせることで、処理が集中する時間帯に他のOSにリソースを奪われてしまいパフォーマンスが低下するといった事態を回避することができます。</p>
</div>
	<div class="lightBox">
		<figure>
			<img src="/image/reports/techRep005_01.jpg" alt="相乗りサーバ同士のピーク時間帯をずらす">
		</figure>
	</div>

<h2>使用する物理リソースを分ける</h2>
<div class="msgWrap">
	<p>仮想化環境では、1つの物理リソースを複数の仮想OSで共用することが可能です。たとえば、1つのCPUコアを、仮想サーバAと仮想サーバBで使用することができるということです。これには便利な点もありますが、パフォーマンスを重視する場合には、あまり望ましい状態ではありません。</p>
	<p>よって、個々のサーバに別々のハードウェアリソースを割り当て、互いに他者の領域を侵さないことで、パフォーマンスの低下を防ぐことができます。</p>
</div>
	<div class="lightBox">
		<figure>
			<img src="/image/reports/techRep005_02.jpg" alt="使用する物理リソースを分ける">
			<figcaption>（※2）ハイパーバイザー：<br />
		ハードウェアの仮想化を実現する低レベルのソフトウェア。動作に特定のOSを必要とせず、ハイパーバイザーの組み込みだけで、複数OSを動かす仮想環境を実現できる。</figcaption>
		</figure>
	</div>
	<br>
	<p>ハードウェアリソースごとの目安と注意点を、以下にまとめます。</p>
	<div class="lightBox">
		<figure>
			<img src="/image/reports/techRep005_03.gif" alt="ハードウェアリソースごとの目安と注意点">
		</figure>
	</div>
	<br>
	<p>このように、仮想サーバ同士によるリソースの奪い合いを回避することができれば、仮想化環境においても、必要なパフォーマンスを確保することは十分に可能です。</p>
	<br>
	<p>次回は障害対策（バックアップ／リストア）についてご紹介します。</p>
