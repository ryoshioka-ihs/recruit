---
title:         "仮想化環境における構築・運用のポイント 第4回"
description:   "前回の記事では、ハードウェア保守切れおよび陳腐化への対応について考察しました。今回は、第1回で挙げた5つの課題の中から、「本番・保守・開発・テスト環境の効率化」について考えていきたいと思います。"
keywords:      ""
date:          2009-09-01 00:30:00 +0900
link:		       ""
categories: 
- "インフラ構築"
- "運用サービス"
- "技術レポート"
tags:
- "仮想化"
- "VMware"
---

<p>前回の記事では、ハードウェア保守切れおよび陳腐化への対応について考察しました。<br>今回は、第1回で挙げた5つの課題の中から、「本番・保守・開発・テスト環境の効率化」について考えていきたいと思います。<br>
<br>
仮想化をご検討の際は、是非IIMヒューマン・ソリューションにお問い合せください。</p>

<h2>今回のテーマ：本番・保守・開発・テスト環境の効率化</h2>
<div class="msgWrap">
<p>仮想化による最大のメリットは、環境構築の容易さです。<br />
	実際のシステム環境では、一般のユーザが利用する環境（本番環境）の他に、管理者や開発者が使用する環境が複数存在します。</p>
	<br>
	<p>例として、次のようなものがあります。</p>
	<ul class="grayDisc">
		<li>[保守環境]<br>
		管理者・運用者が、設定変更やセキュリティパッチ適用などの作業を本番環境で実施する前に、その変更が本当に問題ないのか確認するために使用</li>
		<li>[開発環境]<br>
		開発者が新しいシステムを開発したり、既存のシステムを改修したりするために使用</li>
		<li>[テスト環境]<br>
		開発者が、新しいシステムや改修したシステムの動作に問題がないかテストするために使用</li>
	</ul>
	<br>
	<p>これらの環境は、「いずれ本番環境に反映する」ことを前提とするため、本番環境と似た構成で構築されます。仮想化を用いずに、これらの環境を使用するためには、環境ごとに次のような手順を踏む必要があります。</p>
	<ul class="numList">
		<li>物理サーバ準備</li>
		<li>サーバセットアップ</li>
		<li>データセットアップ</li>
	</ul>
	<br>
	<p>このため、作業者は同じ作業を何度も繰り返す必要があり、また実際に環境が利用可能になるまでにかなりの時間が必要となります。仮想化環境では、仮想サーバのイメージを複製して環境を構成することが可能になるため、時間と作業の無駄を省くことができます。</p>
	<br>
	<p>それでは、仮想化による効率的な環境構築のポイントをご紹介します。</p>
</div>

<h2>雛型（マスタ）イメージを利用する</h2>
<div class="msgWrap">
	<p>仮想化環境では、イメージ複製によってすばやく同じ構成のサーバを作成することができます。つまり、あらかじめ標準とするOSやソフトウェアのインストール、設定を済ませた雛型イメージを作成しておき、それを複製することで作業時間を大幅に短縮することが可能です。</P>
		<br>
		<p>また、インストールするソフトウェアの種類や設定がサーバによって異なるという事態も防ぐことができるため、管理面・セキュリティ面でも効果的です。</p>
	</div>
	<div class="lightBox">
		<figure>
			<img src="/image/reports/techRep004_01.jpg" alt="">
		</figure>
	</div>
	<div class="msgWrap">
		<p>この方法でサーバを導入する際、注意しなければならない点は次の通りです。</p>

		<h3>導入したい製品が雛型のイメージ展開に対応しているか</h3>
		<p>ソフトウェアによっては、イメージ複製による展開に対応していないものも存在します。また、Windowsにおけるsysprep<small class="notes">（※1）</small>のように、イメージ複製時にサーバ固有のIDの再生成が必要となる場合もありますので、事前に確認が必要です。</p>
		<small class="notes">※1　マシンごとに固有の情報であるコンピュータ名やセキュリティID（SID）をOSから削除・再設定するツール</small>

		<h3>ライセンス数は足りているか</h3>
		<p>イメージ複製によって無計画にサーバを構築していると、気づいた時には購入したライセンス以上のサーバが稼動していたという事態になりかねません。各製品のライセンス体系をきちんと把握し、その範囲を超えないように注意して利用する必要があります。</p>
	</div>


<h2>環境を複製して再利用する</h2>
<div class="msgWrap">
	<p>1つの環境が整ったら、その環境を構成するサーバイメージをまるごと複製して、同じ構成の環境を作成することができます。<br />
		こうすることで、テスト環境と本番環境の構成が違っていたため、テストを通過したはずのシステムが本番環境で動かなかった...いうような事態を回避することができます。</p>
	</div>
	<div class="lightBox">
		<figure>
			<img src="/image/reports/techRep004_02.jpg" alt="">
		</figure>
	</div>
	<div class="msgWrap">
		<p>また、システムの開発では、複数のチームに分かれて作業を進めるケースもあります。そして、複数のチームで環境を共用する場合、作業の工程によっては、あるチームが作業をしている間、他のチームが手を止めなければならないこともあります。</p>
		<br>
		<p>このような場合、事前に開発環境のイメージを用意しておき、各チームにそれを配ることで、同じ構成の環境で効率よく作業を進めることができるようになります。</p>
		<br>
		<p>このような場合に注意しなければならない点は、次の通りです。</p>

		<h3>同時に環境を立ち上げたとき、競合を起こす設定はないか</h3>	
		<p>イメージを複製した場合、まったく同じ設定のサーバが複数できることになります。それぞれが互いに通信しない環境（Closed環境）で利用する場合は良いのですが、同じネットワーク上で利用するような場合は、IPアドレスなどが競合を起こさないように、一部の設定を変更する必要があります。</p>
		
		<h3>イメージに含まれているデータに問題はないか</h3>	
		<p>たとえば、実環境のデータベースサーバのイメージには、実際のデータがそのまま含まれます。よって、セキュリティ上問題があるようなデータは、事前に削除するか、テスト用データに置き換えてから配布する必要があります。これは、業務データだけでなく管理者パスワードのようなものについても同様です。</p>
	</div>

<h2>同じ構成で小さいサイズの仮想サーバを作るには</h2>
<div class="msgWrap">
	<p>保守環境や開発環境、テスト環境は、構成は同じでも規模は最低限に留めたいものです。</p>
	<br>
	<p>たとえば、データベースサーバを開発用に別途用意したい場合、実環境と同じサイズの仮想サーバを乗せられるだけのハードディスク容量を用ることは難しいでしょう。</p>
	<br>
	<p>このような場合、<a href="/topics/2009/09/techRep003.html">「仮想化環境における構築・運用のポイント 第3回」</a>でもご紹介したVMware nverterが有用です。このツールを用いれば、元の仮想サーバイメージからスペックだけを下げた仮想サーバを自動で作成することができます。<p>
	</div>
	<div class="lightBox">
		<figure>
			<img src="/image/reports/techRep004_03.jpg" alt="">
			<figcaption class="title">※VMware Converterで圧縮できるのは、空き領域のみです。<br>小サイズのサーバイメージを作成したい場合は、元の仮想サーバから不要なデータを削除し、使用容量を最低限に絞った状態でツールを実行してください。</figcaption>
		</figure>
	</div>
	<div class="msgWrap">
		<p>次回はサーバ個々のパフォーマンスチューニングについてご紹介します。</p>
		<br>
		<p>上記内容に関して、ご不明な点またはご質問などがございましたら、お気軽にお問い合せ下さい。また、インフラ構築作業に関しましてご興味がございましたら、弊社営業担当までお問い合せ下さい。</p>
	</div>