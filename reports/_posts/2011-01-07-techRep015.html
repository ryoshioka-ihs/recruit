---
title:         "マイクロソフト製品で実現するクライアント仮想化（第三回）"
description:   ""
keywords:      ""
date:          2011-01-07 00:00:00 +0900
link:		   ""
categories:
- "技術レポート"
tags:
---

<p>前回の記事では、ターミナルサービスを使用したクライアントの仮想化についてご紹介しました。<br />
今回は、Virtual Desktop Infrastructure (VDI)を使用したクライアント仮想化について説明して行きたいと思います。</p>

<h2>VDIとは</h2>
<p>VDIは、ターミナルサービスと同じくRDPを使用したリモート・デスクトップ型のクライアント仮想化技術です。ただし、ターミナルサービスが1つの仮想デスクトップ環境に複数のユーザーが接続するのに対し、VDIではユーザーごとに個別の仮想マシン（または仮想マシンのプール）が提供される点が異なっています。</p>
<div class="lightBox">
	<figure>
		<img src="/image/reports/techRep015_01.jpg" alt="VDIとは">
	</figure>
</div>
<br>
<p>このように、VDIでは個々のユーザーが利用する環境がOSレベルで分離しているため、マルチユーザーに対応していないアプリケーションでも利用することができます。さらに、デスクトップ環境は仮想マシンとして構成されるためWindows VistaとWindows 7のような異なるOS環境を提供でき、またハードウェアとデスクトップ環境のライフサイクルを切り離して運用できるというメリットもあります。</p>

<h2>Windows Server 2008 R2のVDI</h2>
<p>Windows Server 2008 R2では、「リモートデスクトップサービス」の役割サービスの1つとしてVDIの機能が提供されています。 「リモートデスクトップサービス」は、Windows Server 2008までの「ターミナルサービス」の役割がR2のVDI対応に伴い改名されたもので、新しく[リモートデスクトップ仮想化ホスト]役割サービスが追加されました。 [リモートデスクトップ仮想化ホスト]は、Hyper-V 2.0をVDIに対応させるためのエージェントの役割を果たすコンポーネントで、Hyper-Vサーバーに導入します。</p>
<div class="lightBox">
	<figure>
		<img src="/image/reports/techRep015_02.jpg" alt="Windows Server 2008 R2のVDI">
	</figure>
</div>

<h2>VDI構成イメージ</h2>
<p>Windows Server 2008 R2によるVDIの実現イメージは、次の通りです。</p>
<div class="lightBox">
	<figure>
		<img src="/image/reports/techRep015_03.jpg" alt="Windows Server 2008 R2のVDI" style="border: 1px solid #ccc;">
	</figure>
</div>
<br>
<p>ユーザーが、RD Webアクセス、RDゲートウェイなどを通じてVDIへ接続要求を行うと、RDセッションホストが要求を受けつけ、RD接続ブローカにセッション情報の問い合わせを行います。RD接続ブローカは、既存の接続が存在する場合はその仮想OSへリダイレクトを行い、存在しない場合はRD仮想化ホスト上に構成された仮想デスクトッププールの中から、使用されていない仮想マシンを割り当てます。<br />
<br>
また、個人用仮想デスクトップが設定されている場合には、Active Directoryに問い合わせてそのユーザーに関連付けられた仮想マシンを割り当てます。</p>

<h2>個人用仮想デスクトップと仮想デスクトッププール</h2>
<p>VDIでは、個人用仮想デスクトップと仮想デスクトッププールという2種類の公開方式が提供されています。<br/>
<br>
個人用デスクトップは、仮想OSとActive Directoryユーザーを1:1に紐付ける公開方式で、ユーザーは常に自分専用の仮想マシンが割り当てられます。仮想デスクトッププールは、同じ構成の仮想マシンで構成されたプールの中から、使用されていない仮想マシンを自動で割り当てる公開方式です。ユーザーのセッション情報はRD接続ブローカによって管理され、ユーザーがログオフを行うまで同じ仮想マシンに再接続が可能です。</p>

<h2>VDIの制限事項</h2>
<p>Windows Server 2008 R2のVDIを使用するにあたっては、以下の制限事項があります。</p>
<h3>Active Directory環境</h3>
<ul class="grayDisc">
	<li>VDI役割サービスを構成するすべてのサーバーと仮想デスクトップのゲストOSがドメインのメンバであること</li>
	<li>ドメインの機能レベルがWindows Server 2003以上であること</li>
	<li>個人用デスクトップを使用する場合は、ドメインの機能レベルがWindow Server 2008以上で、かつDCがWindows Server 2008 R2であること</li>
</ul>
<h3>サーバー環境</h3>
<ul class="grayDisc">
	<li>VDI用のRDセッションホストは、RemoteAppや通常のリモートデスクトップサービス用のRDセッションホストとしては使用不可</li>
	<li>RD接続ブローカは、RD仮想化ホストおよびドメインコントローラには追加インストール不可</li>
</ul>
<h3>クライアント環境</h3>
<ul class="grayDisc">
	<li>RDP 6.1以上をサポートしていること<br>
（標準では、Windows 7、Windows Vista SP1以上、Windows XP SP3以上）</li>
</ul>
<br>
<p>VDIはクライアント仮想化技術の中では新しいモデルであり、ターミナルサービスなどの従来の方式に比較して、初回導入時のハードルはやや高めです。しかしながら、ユーザーにはリッチクライアント環境を提供しつつ、同時にクライアント環境の集中管理も実現できるというメリットがあります。<br/>
クライアント仮想化を検討される際には、VDIも選択肢の一つとしてお考えください。</p>
<br>
<p>上記内容に関して、ご不明な点またはご質問などがございましたら、お気軽にお問い合わせ下さい。<br/>
また、仮想化作業に関しましてご興味がございましたら、 IIMヒューマン・ソリューション営業担当までお問い合わせ下さい。</p>