---
title:         "仮想化環境における構築・運用のポイント 第2回"
description:   "サーバの仮想化は、昨今のIT業界において注目されているテーマの1つです。当社ではVMware Infrastructure導入作業、運用手順書作成などの実績から、仮想化環境構築のノウハウをご紹介します。"
keywords:      "仮想化,VMware,vShere,vCenter,ESXi"
date:          2009-09-01 00:10:00 +0900
link:		       ""
categories:
- "技術レポート"
tags:
---

<p>前回の記事では、サーバ運用管理者が抱える問題を列挙させていただききました。
そこで、今回からは先に挙げた課題について、一つずつ踏み込んで考えていきたいと思います。</p>
<h2>物理サーバの統合</h2>
<div class="msgWrap">
	<p>仮想化を導入する目的として、第一に挙げられるのはサーバ統合です。<br>「サーバ統合」とは、社内に散在する多数のサーバを少数の物理サーバに集約させ、サーバ台数を削減することで、運用コストを抑えようという試みです。<br>システム運用で発生するコストには、次のようなものがあります。</p>
	<br>
	<ul class="bgrayDisc">
		<li>ハードウェア費用</li>
		⇒ 物理サーバ、ストレージなどの購入／保守費用
		<li>電気代</li>
		⇒ サーバを稼動させるために必要な消費電力
		<li>人件費</li>
		⇒ サーバの運用管理者の人件費
	</ul>
	<br>
	<p>これらのコストは、サーバの台数にほぼ比例すると考えられます。すなわち、サーバ台数を減らすことで、これらのコスト削減が期待できます。</p>
</div>

<h2>稼動OS数はそのままで物理サーバ台数を削減</h2>
<div class="lightBox">
	<figure>
		<img src="/image/reports/techRep002_01.gif" alt="">
	</figure>
</div>
<div class="msgWrap">
	<p>しかし、サーバ台数を減らそうとするあまり、やみくもに仮想サーバを詰め込んでしまっては、かえって運用に支障をきたす恐れがあります。そこで、サーバ統合を行うにあたって考慮すべきことは何か、そのポイントについてご紹介していきたいと思います。</p>
</div>

<h2>仮想化する対象を見極める</h2>
<div class="msgWrap">
	<p>仮想化は便利な技術ですが、必ずしも万能なソリューションではありません。まずは、仮想化したほうが良いシステムと、仮想化せずに物理 サーバ上で稼動させるほうが良いシステムを切り分ける必要があります。<br>
	両者を切り分けるチェックポイントは、次のようなものがあります。</p>
</div>
<ul class="numList">
	<li><!-- [1] -->
		<p>仮想化環境で動作するシステムか？</p>
		<p>システムによっては、仮想化に対応していないものも存在します。代表的なものでは、ハードウェアと直接対話するシステムや、独自のデバイスを使用するシステムが挙げられます。特に注意が必要なシステムは、次のとおりです。</p>
		<ul class="grayDisc">
			<li>テープ装置にバックアップを取得するバックアップシステム</li>
			<li>ハードウェア障害を検知する監視システム</li>
		</ul>
	</li>
	<li><!-- [2] -->
		<p>性能要件を満たせるか？</p>
		<p>仮想化環境では、1台の物理サーバで複数のOSが稼動することや、OSとハードウェアの間に仮想化層を挟むことから、物理サーバ上で直接OSを稼動させた場合と比較して、パフォーマンスが低下する可能性があります。仮想化環境にてボトルネックになり得るシステムは、次のとおりです。</p>
		<ul class="grayDisc">
			<li>集中アクセスが見込まれるWebサーバ</li>
			<li>大量のトランザクションI/Oが見込まれるDBサーバ</li>
		</ul>
		<br>
		<p>以上の点を考慮したうえで、費用対効果が得られないと判断した場合には、仮想化対象から除外することも検討すべきです。</p>
	</li>
</ul>

<h2>仮想サーバの割り振りを考える</h2>
<p>サーバ統合では、1台の物理サーバで複数のOSが稼動することが基本となります。よって、仮想化対象を決定したら、仮想サーバの配置を決定する必要があります。その際に考慮すべきポイントは、次のとおりです。</p>
<ul class="numList">
	<li><!-- [1] -->
		<p>ハードウェアリソースを効率的に使えているか？</p>
		<p>システムによって、必要となるハードウェアリソースは異なります。物理サーバのリソースを十分に活用するためには、それぞれの仮想サーバが必要とするハードウェアリソースを確認し、同居させる仮想サーバの組み合わせを検討する必要があります。</p>
		<div class="lightBox">
			<figure>
				<img src="/image/reports/techRep002_02.gif" alt="">
			</figure>
		</div>
	</li>
	<li><!-- [2] -->
		<p>物理サーバが停止したとき、影響を最小限にとどめられるか？</p>
		<p>1台のサーバで複数のOSが稼動するということは、1台の物理サーバの停止で、複数のOSが停止する可能性があるということです。考えられる物理サーバ障害の対策には、次のようなものがあります。</p>
		<br>
		<!-- ①代替／予備機（コールドスタンバイ）を準備する -->
		<p style="font-weight: bold">①代替／予備機（コールドスタンバイ）を準備する</p>
		<p>コールドスタンバイとは、同じ構成のシステムを2系統用意しておき、片方(本番系)を動作させ、もう片方(待機系)は動作させずに待機状態にしておき、本番系に障害が発生すると待機系が立ち上がり、処理が切り替わることでシステムの停止を回避する仕組みです。</p>
		<div class="lightBox">
			<figure>
				<img src="/image/reports/techRep002_03.gif" alt="">
			</figure>
		</div>
		<br>
		<!-- ②複数の仮想サーバで冗長化構成を取り、別々の物理サーバに配置する -->
		<p style="font-weight: bold">②複数の仮想サーバで冗長化構成を取り、別々の物理サーバに配置する</p>
		<p>冗長化とは、最低限必要な量より多めに設備を用意しておき、一部の設備が故障してもサービスを継続して提供できるようにシステムを構築することです。</p>
		<div class="lightBox">
			<figure>
				<img src="/image/reports/techRep002_04.gif" alt="">
				<figcaption class="title">＊NLB（Network Load Balancing）：ネットワーク負荷分散。複数のサーバを 1台のサーバに見せかけて、複数のサーバで負荷を分散する技術。</figcaption>
			</figure>
		</div>
		<br>
		<!-- ③ホット・マイグレーションシステムを導入する（VMotionなど） -->
		<p style="font-weight: bold">③ホット・マイグレーションシステムを導入する（VMotionなど）</p>
		<p>VMotion とは、仮想マシンを無停止のまま別のVMware ESX Server搭載サーバへ移動する機能です。「ホット・マイグレーション」とも呼ばれます。仮想マシン上のサービスを止めずに別のサーバへ移動できるため、計画メンテナンスや管理者による負荷分散などに利用されます。</p>
		<div class="lightBox">
			<figure>
				<img src="/image/reports/techRep002_05.gif" alt="">
			</figure>
		</div>
	</li>
</ul>
<br>
<p>※次回はハードウェア保守期限切れおよび陳腐化への対応についてご紹介します。</p>